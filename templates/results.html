<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript" src="{{url_for('static',filename='vis.min.js')}}"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
	<script src="http://code.highcharts.com/highcharts.js"></script>
    <link href="{{ url_for('static', filename='vis.min.css') }}" rel="stylesheet" type="text/css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script type="text/javascript" src="{{url_for('static',filename='draw.js')}}"></script>
    
</head>
<body>
	{% extends "layout.html" %}
	{% block content %}
	
	<div class='standard'>
		<h1>Results</h1>
		<input id="savedorder" name="order" type="hidden">
		<script>
			var dPath={{ value|tojson }};
		</script>
		<a href="{{ url_for('analyze',ordering=value,mstgraph=mstgraph) }}" id="analysis" target="_blank" class="button" style="float: right">Analyze Orderings</a>
<!-- 		<input id="analysis" type="button" value="Analyze Ordering" onclick="distanceMatrix(dPath);" /> -->
		
		<div class='leftDiv'>
			<h4>Minimum Spanning Tree</h4>
			
			<div id="mynetwork" style="visibility: visible"></div>
			<div id="myorderednetwork" style="visibility: hidden; margin-top: -20em"></div>
			
			<p id="demo"></p>
			<tr>
				<td><input type="checkbox" id="ordered" name="treeview"
					value="ordered" onclick="treeView()">Tree showing specific order</td>
<!-- 				<td><input type="radio" id="ordered" name="treeview" -->
<!-- 					value="ordered">Tree showing specific order</td> -->
			</tr>

			<script>
				var x= {{ edges|tojson }};
				var labels={{ labels_info|tojson }};
				var counts = {{ nodes|tojson }};
				drawWithLabels(counts,x,dPath,labels);
				drawWithoutLabels(counts,x,dPath);
			</script>

			<div id="spdDiv" class="pqContainer"
				style="float: left; clear: left; visibility: hidden; width: 100%">

				<h4>Progression Similarity matrix for data</h4>
				<div id="progressionmatrix"></div>
				<form action="{{url_for('clusterMST')}}" method="get">
					<button type="submit">Recompute with different number of modules</button>
				</form>
				

			</div>
			<br>
			
			
			
			<script>
				var m = {{mtd|tojson}};
				if(m=="spd"){
					document.getElementById("spdDiv").style.visibility = "visible";
					
					var progMat={{progMat|tojson}};
					var data = [
					  {
					    //z: [[1, 20, 30], [20, 1, 60], [30, 60, 1]],
					    z: progMat,
					    type: 'heatmap'
					  }
					];
	
					Plotly.newPlot('progressionmatrix', data);
				}
			</script>

			

			<script>
			var noiseRatio= {{ noise|tojson }};
			var intensityRatio= {{ intensity|tojson }};
			</script>

			<div class="pqContainer" style="float: left; clear: left">

				<h4>
					Noise to signal ratio: {{noise}}<br> Sampling intensity:
					{{intensity}}<br> Select your threshold percent for noise:
				</h4>
				<div id="sliderElem" class="slidecontainer" style="visibility:visible">
			    	
			    	<input type="range" min="1" max="100" value="50" class="slider" id="myRange" name="name_of_slider">
			    	<input id="clickMe" type="button" value="Compute" onclick="sliderFunction(noiseRatio);" />
			  		<p>Value: <span id="slide"></span></p>
			  		
				</div>
			

				<script>
				var slider = document.getElementById("myRange");
				var output = document.getElementById("slide");
				output.innerHTML = slider.value;
				
				slider.oninput = function() {
				  output.innerHTML = this.value;
				}
				</script>
				
				<script>
					var b = {{branch|tojson}};
					if(b==1){
						document.getElementById("sliderElem").style.visibility = "visible";
					}
				</script>
			</div>


		</div>

		<div id="chart" class="rightDiv">
			<h4>Ordering of samples</h4>
<!-- 			<canvas id="myChart1" width="600" height="400"></canvas> -->
				<div id="pca" style="float:left;clear:left"></div>
			<script>
				var order= {{ ordering|tojson }};
				getPCAForOrder(dPath);
			</script>
			
			<p id="message">{{msg}}</p>
			<script>
					graph={{mstgraph|tojson}};
			
			</script>
			
			<div id="pq" class="pqContainer" style="float:left;clear:left;visibility:hidden">
				<h4>Candidate Orderings for samples generated using PQ trees</h4>
				<h5>Enter the number of alternative orderings to display:</h5>
				<td><input type="text" id="pqno" maxlength="4" size="4"></td>
				<td><input id="clickMe" type="button" value="Compute" onclick="computePQ(counts,dPath,graph);" /></td><br>
				<p id="totalPQ"></p><br>
				<p id="pqorder"></p><br>
<!-- 				<div id="orders"></div> -->
				
				
				
				
			</div>
			
		</div>
		
	</div>
	
		
	
	{% endblock %}
</body>
</html>